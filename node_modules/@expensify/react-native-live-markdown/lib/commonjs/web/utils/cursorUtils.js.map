{"version":3,"names":["_blockUtils","require","_treeUtils","setCursorPosition","target","startIndex","endIndex","shouldScrollIntoView","tree","document","activeElement","start","Math","max","min","length","end","range","createRange","selectNodeContents","startTreeNode","getTreeNodeByIndex","endTreeNode","console","error","type","setStartBefore","element","startElement","setStart","childNodes","setEndBefore","endElement","setEnd","collapse","selection","window","getSelection","setBaseAndExtent","startContainer","startOffset","endContainer","endOffset","scrollIntoView","node","scrollTargetElement","targetElement","isChildOfMultilineMarkdownElement","orderIndex","Number","split","currentLine","nodeName","addRange","span","createElement","textContent","insertNode","block","remove","caretRect","getBoundingClientRect","targetRect","top","height","scrollTop","moveCursorToEnd","getCurrentCursorPosition","getHTMLElement","Text","parentElement","rangeCount","getRangeAt","findHTMLElementInTree","parentNode","value","removeSelection","removeAllRanges"],"sourceRoot":"../../../../src","sources":["web/utils/cursorUtils.ts"],"mappings":"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","ignoreList":[]}
